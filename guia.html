<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Guia Completo de Análise de Dados com Machine Learning</title>
    
    <!-- Bootstrap 5 CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.1/font/bootstrap-icons.css" rel="stylesheet">
    
    <!-- Prism.js para highlight de código -->
    <link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet">
    
    <style>
        .hero-section {
            background: linear-gradient(135deg, #4361ee, #3a0ca3);
            color: white;
            padding: 4rem 0;
        }
        
        .feature-card {
            transition: transform 0.3s;
            margin-bottom: 20px;
            border-radius: 10px;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
        }
        
        .feature-card:hover {
            transform: translateY(-5px);
        }
        
        .code-block {
            background: #f8f9fa;
            border-radius: 5px;
            padding: 15px;
            margin: 15px 0;
        }

        .section-title {
            color: #4361ee;
            border-bottom: 2px solid #4361ee;
            padding-bottom: 10px;
            margin-bottom: 30px;
        }
    </style>
</head>
<body>
    <!-- Navbar -->
    <nav class="navbar navbar-expand-lg navbar-dark bg-dark sticky-top">
        <div class="container">
            <a class="navbar-brand" href="#">
                <i class="bi bi-graph-up"></i> Análise Inteligente
            </a>
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="navbarNav">
                <ul class="navbar-nav">
                    <li class="nav-item">
                        <a class="nav-link" href="#inicio">Início</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="#estrutura">Estrutura</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="#exemplos">Exemplos</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="#ml">Machine Learning</a>
                    </li>
                </ul>
            </div>
        </div>
    </nav>

    <!-- Hero Section -->
    <section class="hero-section" id="inicio">
        <div class="container">
            <div class="row align-items-center">
                <div class="col-lg-8">
                    <h1 class="display-4 fw-bold">Análise Inteligente de Dados</h1>
                    <p class="lead">
                        Guia completo do projeto de análise de dados com exemplos práticos
                    </p>
                </div>
            </div>
        </div>
    </section>

    <!-- Estrutura do Projeto -->
    <section class="py-5" id="estrutura">
        <div class="container">
            <h2 class="section-title">Estrutura do Projeto</h2>
            
            <div class="row">
                <!-- Classe Principal: AnalisadorInteligente -->
                <div class="col-md-6">
                    <div class="card feature-card">
                        <div class="card-body">
                            <h5 class="card-title">
                                <i class="bi bi-diagram-3"></i> Classe Principal: AnalisadorInteligente
                            </h5>
                            <div class="code-block">
                                <pre><code class="language-python">
class AnalisadorInteligente:
    def __init__(self):
        self.diretorios = [
            Path('F:/okok/data'),
            Path('F:/okok'),
            Path('.')
        ]
        
        self.arquivos = {
            'julio': '(JULIO) LISTAS INDIVIDUAIS.xlsx',
            'leandro': '(LEANDRO_ADRIANO) LISTAS INDIVIDUAIS.xlsx'
        }
        
        self.status_especificos = [
            'VERIFICADO', 'ANÁLISE', 'PENDENTE', 'PRIORIDADE', 
            'APROVADO', 'QUITADO', 'CANCELADO', 'OUTROS ACORDOS'
        ]</code></pre>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Exemplo de Carregamento de Dados -->
                <div class="col-md-6">
                    <div class="card feature-card">
                        <div class="card-body">
                            <h5 class="card-title">
                                <i class="bi bi-database"></i> Carregamento de Dados
                            </h5>
                            <p class="card-text">
                                O sistema carrega dados de arquivos Excel e normaliza as colunas:
                            </p>
                            <div class="code-block">
                                <pre><code class="language-python">
def carregar_dados(self):
    """Carrega e normaliza dados dos arquivos Excel"""
    diretorio = self.encontrar_diretorio()
    print(f"Diretório de trabalho: {diretorio}")
    
    dados_grupos = {}
    
    for grupo, arquivo in self.arquivos.items():
        dados_colaboradores = {}
        metricas_colaboradores = {}
        
        # Processamento das abas
        for aba in abas:
            df = pd.read_excel(caminho, sheet_name=aba)
            df = self.normalizar_dataframe(df)
            
            if df is not None:
                dados_colaboradores[aba] = df
                metricas = self.calcular_metricas(df)
                metricas_colaboradores[aba] = metricas</code></pre>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Exemplos Práticos -->
    <section class="py-5 bg-light" id="exemplos">
        <div class="container">
            <h2 class="section-title">Exemplos Práticos</h2>
            
            <div class="row">
                <!-- Exemplo de Cálculo de Métricas -->
                <div class="col-lg-12">
                    <div class="card feature-card">
                        <div class="card-body">
                            <h5 class="card-title">
                                <i class="bi bi-calculator"></i> Cálculo de Métricas
                            </h5>
                            <p class="card-text">
                                Exemplo de como as métricas são calculadas para cada colaborador:
                            </p>
                            <div class="code-block">
                                <pre><code class="language-python">
def calcular_metricas(self, df):
    """Calcula métricas de desempenho"""
    total_registros = len(df)
    status_counts = df['STATUS'].value_counts()
    
    # Métricas de eficiência
    aprovados = status_counts.get('APROVADO', 0)
    quitados = status_counts.get('QUITADO', 0)
    taxa_eficiencia = (aprovados + quitados) / total_registros
    
    # Métricas de produtividade
    registros_dia = len(df) / self.dias_uteis
    registros_hora = registros_dia / self.horas_trabalho
    
    return {
        'total_registros': total_registros,
        'status_counts': status_counts,
        'taxa_eficiencia': taxa_eficiencia,
        'produtividade_hora': registros_hora
    }</code></pre>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Exemplo de Análise de Status -->
                <div class="col-lg-12 mt-4">
                    <div class="card feature-card">
                        <div class="card-body">
                            <h5 class="card-title">
                                <i class="bi bi-bar-chart"></i> Análise de Status
                            </h5>
                            <p class="card-text">
                                Como os status são analisados e processados:
                            </p>
                            <div class="code-block">
                                <pre><code class="language-python">
def analisar_status(self, df):
    """Análise detalhada dos status"""
    status_prioritarios = ['APROVADO', 'QUITADO']
    status_counts = df['STATUS'].value_counts()
    
    # Calcular percentuais
    total = len(df)
    percentuais = {}
    for status in self.status_especificos:
        count = status_counts.get(status, 0)
        percentual = (count / total * 100) if total > 0 else 0
        percentuais[status] = percentual
    
    return percentuais</code></pre>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Machine Learning Section -->
    <section class="py-5" id="ml">
        <div class="container">
            <h2 class="section-title">Implementação de Machine Learning</h2>
            
            <div class="row">
                <!-- Random Forest Implementation -->
                <div class="col-md-6">
                    <div class="card feature-card">
                        <div class="card-body">
                            <h5 class="card-title">
                                <i class="bi bi-diagram-3"></i> Random Forest para Classificação
                            </h5>
                            <p class="card-text">
                                Implementação do modelo de Random Forest para classificação de prioridades:
                            </p>
                            <div class="code-block">
                                <pre><code class="language-python">
def treinar_modelo_classificacao(self, X, y):
    """Treina modelo de Random Forest para classificação"""
    # Preparar dados
    X_train, X_test, y_train, y_test = train_test_split(
        X, y, test_size=0.2, random_state=42
    )
    
    # Criar e treinar modelo
    rf_model = RandomForestClassifier(
        n_estimators=100,
        max_depth=None,
        min_samples_split=2,
        random_state=42
    )
    
    rf_model.fit(X_train, y_train)
    
    # Avaliar modelo
    y_pred = rf_model.predict(X_test)
    acuracia = accuracy_score(y_test, y_pred)
    
    return rf_model, acuracia</code></pre>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Gradient Boosting Implementation -->
                <div class="col-md-6">
                    <div class="card feature-card">
                        <div class="card-body">
                            <h5 class="card-title">
                                <i class="bi bi-graph-up-arrow"></i> Gradient Boosting para Previsão
                            </h5>
                            <p class="card-text">
                                Implementação do Gradient Boosting para previsão de métricas:
                            </p>
                            <div class="code-block">
                                <pre><code class="language-python">
def treinar_modelo_regressao(self, X, y):
    """Treina modelo de Gradient Boosting para regressão"""
    # Preparar dados
    X_train, X_test, y_train, y_test = train_test_split(
        X, y, test_size=0.2, random_state=42
    )
    
    # Criar e treinar modelo
    gb_model = GradientBoostingRegressor(
        n_estimators=100,
        learning_rate=0.1,
        max_depth=3,
        random_state=42
    )
    
    gb_model.fit(X_train, y_train)
    
    # Avaliar modelo
    y_pred = gb_model.predict(X_test)
    mse = mean_squared_error(y_test, y_pred)
    
    return gb_model, mse</code></pre>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Footer -->
    <footer class="bg-dark text-light py-4 mt-5">
        <div class="container">
            <div class="row">
                <div class="col-md-6">
                    <h5>Links Úteis</h5>
                    <ul class="list-unstyled">
                        <li><a href="https://scikit-learn.org/" class="text-light">Scikit-learn</a></li>
                        <li><a href="https://pandas.pydata.org/" class="text-light">Pandas</a></li>
                        <li><a href="https://seaborn.pydata.org/" class="text-light">Seaborn</a></li>
                    </ul>
                </div>
                <div class="col-md-6">
                    <h5>Documentação</h5>
                    <ul class="list-unstyled">
                        <li><a href="#estrutura" class="text-light">Estrutura do Projeto</a></li>
                        <li><a href="#exemplos" class="text-light">Exemplos Práticos</a></li>
                        <li><a href="#ml" class="text-light">Machine Learning</a></li>
                    </ul>
                </div>
            </div>
        </div>
    </footer>

    <!-- Scripts -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-python.min.js"></script>
</body>
</html>